<!doctype html>
<html>

<head>
  <script src="https://pixijs.download/release/pixi.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@pixi/tilemap@latest/dist/pixi-tilemap.umd.js"></script>
</head>

<body>
  <script>
    const renderer = PIXI.autoDetectRenderer({
    antialias: true,
    autoDensity: true,
    resolution: window.devicePixelRatio || 1,
    width: 1425,
    height: 690,
});

let stage;
let tilemap;
let frame = 0;

document.body.appendChild(renderer.view);

const loader = new PIXI.Loader();

loader.add('atlas', '/assets/tilemap/atlas.json');
loader.load((_, resources) => {
    // Setup tilemap scene
    stage = new PIXI.Container();
    tilemap = new PIXI.tilemap.CompositeTilemap();
    stage.addChild(tilemap);

    // Setup rendering loop
    PIXI.Ticker.shared.add(() => renderer.render(stage));

    makeTilemap();
});

function makeTilemap() {
    // Clear the tilemap, in case it is being reused.
    tilemap.clear();

    const resources = loader.resources;
    const size = 32;

    // Calculate the dimensions of the tilemap to build
    const pxW = renderer.screen.width;
    const pxH = renderer.screen.height;
    const tileW = pxW / size;
    const tileH = pxH / size;
    // Fill the scene with grass and sparse rocks on top and chests on
    // the bottom. Some chests are animated between two tile textures
    // (so they flash red).
    for (let i = 0; i < tileW; i++) {
        for (let j = 0; j < tileH; j++) {
            tilemap.tile(
                'grass.png',
                i * size,
                j * size,
            );
        }
    }
    // Button does not appear in the atlas, but @pixi/tilemap won't surrender
    // - it will create second layer for special for buttons and they will
    // appear above all the other tiles.
    tilemap.tile(resources.button.texture, 0, 0);
}

  </script>
</body>

</html>